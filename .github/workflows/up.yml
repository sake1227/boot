name: 上传


on:
  workflow_dispatch:
    inputs:
      url:
        description: '下载链接'
        required: true
        default: ''
      name:
        description: '保存名称'
        required: true
        default: ''
      dizhi:
        description: '保存地址'
        required: true
        default: ''
jobs:
  zip:
    runs-on: ubuntu-24.04
    steps:
      - name: 检出代码
        uses: actions/checkout@main

      - name: 信息输出
        run: |
         echo "输入名字：${{ github.event.inputs.rom_name }}"
         echo "下载链接：${{ github.event.inputs.rom_url }}"

      - name: 安装依赖
        run: |
         sudo apt-get update
         sudo apt-get -y install python3-pip
         sudo apt install aria2
         sudo apt-get install p7zip
         
      - name: 同步上传
        run: |
         curl https://rclone.org/install.sh | sudo bash
         mkdir -p ~/.config/rclone/
         unzip -o rclone.zip -d ~/.config/rclone/
         
      - name: 提取镜像
        run: |
         mkdir -p ${GITHUB_WORKSPACE}/workspace && cd ${GITHUB_WORKSPACE}/workspace
         aria2c -s 10 -x 10 -d . -o ${{ github.event.inputs.name }} ${{ github.event.inputs.url }}
         rclone sync ${{ github.event.inputs.name }} 123:/${{ github.event.inputs.dizhi }}
